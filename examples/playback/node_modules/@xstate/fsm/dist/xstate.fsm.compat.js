var t,n;t=this,n=function(t){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function n(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,o,i=e.call(t),a=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return a}var e;(e=t.InterpreterStatus||(t.InterpreterStatus={}))[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped";var r={type:"xstate.init"};function o(t){return void 0===t?[]:[].concat(t)}function i(t,n){return"string"==typeof(t="string"==typeof t&&n&&n[t]?n[t]:t)?{type:t}:"function"==typeof t?{type:t.name,exec:t}:t}function a(t){return function(n){return t===n}}function u(t){return"string"==typeof t?{type:t}:t}function c(t,n){return{value:t,context:n,actions:[],changed:!1,matches:a(t)}}function s(t,n,e){var r=n,o=!1;return[t.filter((function(t){if("xstate.assign"===t.type){o=!0;var n=Object.assign({},r);return"function"==typeof t.assignment?n=t.assignment(r,e):Object.keys(t.assignment).forEach((function(o){n[o]="function"==typeof t.assignment[o]?t.assignment[o](r,e):t.assignment[o]})),r=n,!1}return!0})),r,o]}var f=function(t,n){return t.actions.forEach((function(e){var r=e.exec;return r&&r(t.context,n)}))};t.assign=function(t){return{type:"xstate.assign",assignment:t}},t.createMachine=function(t,e){void 0===e&&(e={});var f=n(s(o(t.states[t.initial].entry).map((function(t){return i(t,e.actions)})),t.context,r),2),l=f[0],p=f[1],v={config:t,_options:e,initialState:{value:t.initial,actions:l,context:p,matches:a(t.initial)},transition:function(e,r){var f,l,p="string"==typeof e?{value:e,context:t.context}:e,y=p.value,d=p.context,g=u(r),x=t.states[y];if(x.on){var m=o(x.on[g.type]);try{for(var S=function(t){var n="function"==typeof Symbol&&t[Symbol.iterator],e=0;return n?n.call(t):{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}}(m),h=S.next();!h.done;h=S.next()){var b=h.value;if(void 0===b)return c(y,d);var I="string"==typeof b?{target:b}:b,j=I.target,_=void 0===j?y:j,R=I.actions,w=void 0===R?[]:R,E=I.cond;if((void 0===E?function(){return!0}:E)(d,g)){var M=t.states[_],N=n(s([].concat(x.exit,w,M.entry).filter((function(t){return t})).map((function(t){return i(t,v._options.actions)})),d,g),3),O=N[0],k=N[1],F=N[2];return{value:_,context:k,actions:O,changed:_!==y||O.length>0||F,matches:a(_)}}}}catch(t){f={error:t}}finally{try{h&&!h.done&&(l=S.return)&&l.call(S)}finally{if(f)throw f.error}}}return c(y,d)}};return v},t.interpret=function(n){var e=n.initialState,o=t.InterpreterStatus.NotStarted,i=new Set,c={_machine:n,send:function(r){o===t.InterpreterStatus.Running&&(e=n.transition(e,r),f(e,u(r)),i.forEach((function(t){return t(e)})))},subscribe:function(t){return i.add(t),t(e),{unsubscribe:function(){return i.delete(t)}}},start:function(i){if(i){var u="object"==typeof i?i:{context:n.config.context,value:i};e={value:u.value,actions:[],context:u.context,matches:a(u.value)}}return o=t.InterpreterStatus.Running,f(e,r),c},stop:function(){return o=t.InterpreterStatus.Stopped,i.clear(),c},get state(){return e},get status(){return o}};return c},Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t=t||self).XStateFSM={});
